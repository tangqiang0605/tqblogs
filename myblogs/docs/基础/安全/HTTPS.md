### 对称加密
未被加密的信息称为明文，被加密的信息称为密文。对信息加密有很多种方式。常见的加密比如凯撒密码、恩格玛机、DES，这些加密方式都是在明文的基础上，使用密钥进行运算得出的密文。密钥通常是一串复杂的字符串，结合特定的算法，可以对密文进行解密：输入<密文，密钥>，输出<明文>。有的密钥可以在将明文转换为密文之后，也可以把密文转化为明文，那么接受方和发送方，只要拥有相同的密钥，就可以随意加密数据，以密文的方式传输到对方手里，而攻击者得到密文而没有密钥，是无法直接知道明文的内容的，这就是对称加密。

A 和 B 想通信，可以直接发送明文给 B，但是这样敏感内容（比如密码）会被其他人获取，所以 A 和 B 需要加密通信。A 把加密的方法（密钥）告诉 B，接下来 A 和 B 就可以通过密文的形式通信啦。

### 异或加密
异或是二进制中的常用运算，当两个数相同时结果为 0，否则为 1。异或加密就是将明文异或密钥得到密文的操作。异或加密因为很简单，所以很容易被破解，很多情况下只是用来对明文进行简单验证。这里之所以提到异或，是因为异或是对称加密中最简单的一种。比如明文是 100，密钥是 101，异或得到密文 001，这是加密。密文 001，异或密钥 101，得到 100，这是解密。可见，对称加密的用来加密的密钥和用来解密的密钥是相同的。

### 非对称加密
然而对称加密存在的问题是，一开始其中一方并没有对方的密钥，需要对方将密钥以明文的形式发给自己，如果攻击者截取到这条消息，那么三方就都有密钥。这时，攻击者就可以对信息进行解密、窃听甚至是篡改。

因此，我们需要一种有效方法来保证我们密钥的安全。上面说过，在对称加密中使用的密钥既可以加密又可以解密。实际上还有另外一种密钥，他们是通过某种安全的算法酸出来的一对密钥，一把用来加密，但是无法解开自己加密的内容，而需要另一把密钥来解开。用于加密的称为公钥，用于解密的称为私密。对称加密的密钥虽然只有一把，但也可以看成是一对值是相同的公钥密钥。而非对称加密的公钥密钥则是不同的，而且也无法通过公钥计算出密钥，这就是对称加密和非对称加密的根本区别。

非对称加密使用特殊算法，算出值不同的公钥和私钥。只得到了公钥，只能对数据进行加密，而无法猜出私钥，也就无法对数据进行解密。A 和 B 想通过非对称加密进行通信，具体过程是这样的。B 生成一把公钥和一把私钥，然后把公钥交给 A，A 就可以对数据进行加密，然后发给 B，这时攻击者就算得到公钥和 A 发送给 B 的消息，也无法对其进行解密，只有发送者 A 知道自己发送了什么，而接受者 B 通过私钥解密，也可以得到 A 发送的信息。

### SSL 握手
通过非对称加密，攻击者没有密钥就无法解密，通过对称加密，攻击者就算有密钥，也无法解密。但是只靠其中一方生成密钥也是不安全的。一个更好的方法是，B 生成公钥私钥，把公钥交给 A，A 也生成公钥私钥，并用 B 的公钥加密自己的公钥发给 B。这样，双方使用对方的公钥加密，使用自己的私钥解密。除了 B 的公钥可能被攻击者获取（但是对于攻击者来说没什么用），其他信息都是没有私钥无法破解的密文。

这种对称加密和非对称加密结合建立双方连接的方法，称为 SSL 握手。SSL 即安全套接字层 Secure Socket Layer，SSL 握手即安全套接字层握手，后来该技术被标准化，称为 TLS。该层与 HTTP 协议层一起，构成了 HTTPS 协议。HTTPS 的出现就是为了保护通信不受中间人攻击。

### 中间人攻击
在网络上，通信双方的通信往往要经过很多中间媒介，难免被中间者截获并利用。比如网络运营商就能获得你发送的信息，如果你流量欠费，那就会修改其他人发给你的信息，附上流量欠费的通知，而后续别人发给你的消息或者你的网络请求，都被拦截无法发出和接受。

在上面对对称加密的介绍中，就是为了预防中间人攻击。HTTP 的通信是以明文，中间人随时可以劫持和修改信息，因此有了对称加密，然而对称加密的密钥也可以被中间人捕获，因此又有了 HTTPS 的非对称加密。非对称加密真的安全吗？并不是。当 B 发送公钥给 A 时，中间人可以截取下来，把自己的公钥发给 A，A 得到的就是中间人的公钥而不是 B 的密钥，A 使用公钥加密，然后发给 B，此时被中间人截获并用私钥进行解密，A 的信息（如银行卡密码）就暴露了。因此非对称加密确实做到了没有私钥无法解密，但是仍然无法防范中间人攻击。

### TLS 证书
为了防范中间人攻击，CA 机构成立了。CA 即证书授权 Certificate Authority。CA 机构给正规网站分发 TLS 证书。这种证书需要网站向 CA 机构申请。网站将自己的公钥和其他信息合在一起发给 CA，CA 使用自己的公钥进行加密，然后返回给网站，这个过程就是**签名**。网站把提供给 CA 的信息和 CA 给的签名放在一起，就是自己的 TLS 证书了。

当用户访问网站时，网站把 TLS 证书发给用户，用户再把证书交给 CA，CA 对签名进行解密验证是不是自己颁发的证书，如果是，就返回给用户，如果不是，就会提示用户网站有风险。在这种情况下，中间人自己的公钥并不是证书上的公钥，也就无法欺骗网站和用户了。

CA 机构往往由业内具有声望的公司担任，往往是受国家认可的单位才有权颁发 TLS 证书，而遵循 HTTPS 协议的网站也一般需要向 CA 申请 TLS 证书，这些申请需要费用同时也比较严格，所以支持 HTTPS 协议的网站一般都是比较可靠的。

### CT 认证
然而，CA 认证并不是无懈可击的。CA 集中了颁发证书的权力，也就具备了中心化的缺点。中间人可以通过贿赂 CA 机构的工作人员，让他们颁发证书以此来两头窃取网站和用户的信息。美国棱镜计划（一个国家窃听他人电话、网络等信息的计划）可能就是通过以国家力量强迫 CA 机构给他们的窃听机构颁发证书，作为中间人来窃听用户的网络通信。

CT 认证运用了和区块链相似的技术--去中心化。每次 CA 颁发证书，都提交一条记录给 CT，并在 TLS 证书中携带 SCT 信息表示这个证书的信息提交给了 CT，所有人都可以看到 CT 中的记录，因此所有用户都是拥有 CT 认证权利的用户，网站可以通过这种方式，查看 CA 机构是否发布了危害自己的证书。现在各家浏览器都要求证书必须携带 SCT，不然则会提示用户网站不安全。

>参考
>
> https://www.bilibili.com/video/BV1uY4y1D7Ng/?spm_id_from=333.337.search-card.all.click